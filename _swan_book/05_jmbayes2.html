<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Randy Jin, Elizabeth Juarez-Colunga">
<title>SWAN AMH project analysis - 5&nbsp; JMbayes2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_jm_model_selection.html" rel="next">
<link href="./04_jmbayes.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://hypothes.is/embed.js"></script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SWAN AMH project analysis</span>
  </a>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">JMbayes2</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        <div class="sidebar-tools-collapse tools-wide">
    <a href="https://github.com/Goodgolden/jm_amh" title="" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="" class="sidebar-tool px-1"><i class="bi bi-share"></i></a>
    <a href="https://coloradosph.cuanschutz.edu/education/departments/biostatistics-informatics" title="" class="sidebar-tool px-1"><i class="bi bi-hospital"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Working log</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_table1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Table1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_jm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">JM</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_model_selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model selection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_jmbayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">JMBayes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_jmbayes2.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">JMbayes2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_jm_model_selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">JM Model Selection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_value_auc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Value model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_rate_auc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rate model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_table1_publication.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Table1 (for publication)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_final_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Final model (for publication)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_convergence.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Convergence</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_model_selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model Selection I - Dummy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_model_selection_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Model Selection II - Factor</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_rate_value_baseline.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rate Value Baseline</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_auc_ci.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">AUC CI</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Paper Review</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#goal-for-this-chapter" id="toc-goal-for-this-chapter" class="nav-link active" data-scroll-target="#goal-for-this-chapter"> <span class="header-section-number">5.1</span> Goal for this chapter</a></li>
  <li>
<a href="#no-sites-in-the-survival-model" id="toc-no-sites-in-the-survival-model" class="nav-link" data-scroll-target="#no-sites-in-the-survival-model"> <span class="header-section-number">5.2</span> No sites in the survival model</a>
  <ul class="collapse">
<li><a href="#lme-models-and-surv-models" id="toc-lme-models-and-surv-models" class="nav-link" data-scroll-target="#lme-models-and-surv-models"> <span class="header-section-number">5.2.1</span> lme models and surv models</a></li>
  <li><a href="#joint-models-summarization" id="toc-joint-models-summarization" class="nav-link" data-scroll-target="#joint-models-summarization"> <span class="header-section-number">5.2.2</span> Joint models summarization</a></li>
  </ul>
</li>
  <li><a href="#nested-linear-mixed-model" id="toc-nested-linear-mixed-model" class="nav-link" data-scroll-target="#nested-linear-mixed-model"> <span class="header-section-number">5.3</span> Nested linear mixed model</a></li>
  <li>
<a href="#prediction-accuracy" id="toc-prediction-accuracy" class="nav-link" data-scroll-target="#prediction-accuracy"> <span class="header-section-number">5.4</span> Prediction Accuracy</a>
  <ul class="collapse">
<li><a href="#dynamic-prediction" id="toc-dynamic-prediction" class="nav-link" data-scroll-target="#dynamic-prediction"> <span class="header-section-number">5.4.1</span> Dynamic prediction</a></li>
  <li><a href="#auc" id="toc-auc" class="nav-link" data-scroll-target="#auc"> <span class="header-section-number">5.4.2</span> AUC</a></li>
  <li><a href="#calibration-plot" id="toc-calibration-plot" class="nav-link" data-scroll-target="#calibration-plot"> <span class="header-section-number">5.4.3</span> Calibration Plot</a></li>
  <li><a href="#roc" id="toc-roc" class="nav-link" data-scroll-target="#roc"> <span class="header-section-number">5.4.4</span> ROC</a></li>
  <li><a href="#brier-score" id="toc-brier-score" class="nav-link" data-scroll-target="#brier-score"> <span class="header-section-number">5.4.5</span> Brier Score</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/Goodgolden/jm_amh/edit/main/05_jmbayes2.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">JMbayes2</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div class="cell" data-hash="05_jmbayes2_cache/html/css-setup_6bb1a477be97682dc558d0e5954a0106">
<style type="text/css">
.scroll-100 {
  max-height: 300px;
  max-width: 1000px;
  overflow-y: auto;
  background-color: inherit;
}
</style>
</div>
<section id="goal-for-this-chapter" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="goal-for-this-chapter">
<span class="header-section-number">5.1</span> Goal for this chapter</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" checked="">
Fitting the models with <code>JMbayes2</code> package</p></li>
<li><p><input type="checkbox" disabled="" checked="">
Removing the site from the survival model, might be the issue!!</p></li>
<li><p><input type="checkbox" disabled="" checked="">
Nested linear model with <code>id</code> and <code>site</code> failed</p></li>
<li><p><input type="checkbox" disabled="" checked="">
Dynamic predictions for the survival outcomes worked</p></li>
<li><p><input type="checkbox" disabled="" checked=""><code>JM</code>, <code>JMbayes</code>, and <code>JMbayes2</code> packages does not support factorized covariates</p></li>
<li><p><input type="checkbox" disabled="" checked=""><code>JMbayes2</code> for AUC, ROC, calibration plots, and the Brier Score</p></li>
<li><p><input type="checkbox" disabled="" checked="">
You are amazing!</p></li>
</ul></section><section id="no-sites-in-the-survival-model" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="no-sites-in-the-survival-model">
<span class="header-section-number">5.2</span> No sites in the survival model</h2>
<p>Here we are working with survival model without site. I also include the site into the nested design random effect in the longitudinal model <code>lme.fit4</code>.</p>
<div class="cell" data-hash="05_jmbayes2_cache/html/loading data_43e60aa05f17ab816903d858ff6c4e49">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/swan_amh0.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/swan_amh1.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">swan_amh0</span> <span class="op">&lt;-</span> <span class="va">swan_amh0</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>site <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">site</span> <span class="op">==</span> <span class="st">"11"</span> <span class="op">~</span> <span class="st">"M"</span>,</span>
<span>                          <span class="va">site</span> <span class="op">==</span> <span class="st">"12"</span> <span class="op">~</span> <span class="st">"B"</span>,</span>
<span>                          <span class="va">site</span> <span class="op">==</span> <span class="st">"13"</span> <span class="op">~</span> <span class="st">"C"</span>,</span>
<span>                          <span class="va">site</span> <span class="op">==</span> <span class="st">"14"</span> <span class="op">~</span> <span class="st">"UCD"</span>,</span>
<span>                          <span class="va">site</span> <span class="op">==</span> <span class="st">"15"</span> <span class="op">~</span> <span class="st">"UCLA"</span>,</span>
<span>                          <span class="va">site</span> <span class="op">==</span> <span class="st">"16"</span> <span class="op">~</span> <span class="st">"NJ"</span>,</span>
<span>                          <span class="va">site</span> <span class="op">==</span> <span class="st">"17"</span> <span class="op">~</span> <span class="st">"P"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="lme-models-and-surv-models" class="level3" data-number="5.2.1"><h3 data-number="5.2.1" class="anchored" data-anchor-id="lme-models-and-surv-models">
<span class="header-section-number">5.2.1</span> lme models and surv models</h3>
<div class="cell" data-hash="05_jmbayes2_cache/html/fitting models_050a54b2b99670bb6627c17367f64684">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">control</span> <span class="op">=</span> <span class="fu">lmeControl</span><span class="op">(</span>opt <span class="op">=</span> <span class="st">"optim"</span><span class="op">)</span></span>
<span><span class="va">lme.fit1</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">lamh</span> <span class="op">~</span> <span class="va">time</span>,</span>
<span>                data <span class="op">=</span> <span class="va">swan_amh0</span>,</span>
<span>                control <span class="op">=</span> <span class="va">control</span>,</span>
<span>                random <span class="op">=</span> <span class="op">~</span> <span class="va">time</span><span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lme.fit2</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">lamh</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">swan_amh0</span>,</span>
<span>                control <span class="op">=</span> <span class="va">control</span>,</span>
<span>                random <span class="op">=</span> <span class="op">~</span> <span class="va">time</span><span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lme.fit3</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">lamh</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">swan_amh0</span>,</span>
<span>                control <span class="op">=</span> <span class="va">control</span>,</span>
<span>                random <span class="op">=</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lme.fit4</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">lamh</span> <span class="op">~</span> <span class="va">time</span>,</span>
<span>                data <span class="op">=</span> <span class="va">swan_amh0</span>,</span>
<span>                control <span class="op">=</span> <span class="va">control</span>,</span>
<span>                random <span class="op">=</span> <span class="op">~</span> <span class="va">time</span><span class="op">|</span> <span class="va">site</span> <span class="op">/</span> <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">surv.fit1</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">etime</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">married</span> <span class="op">+</span> <span class="va">bc_pills</span> <span class="op">+</span> </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                        <span class="va">bmi</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ethnic</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">smoke</span><span class="op">)</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">swan_amh1</span>,</span>
<span>                    x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">surv.fit1.nosite</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">etime</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">married</span> <span class="op">+</span> <span class="va">bc_pills</span> <span class="op">+</span> </span>
<span>                        <span class="co"># factor(site) + </span></span>
<span>                        <span class="va">bmi</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ethnic</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">smoke</span><span class="op">)</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">swan_amh1</span>,</span>
<span>                    x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">surv.fit2.nosite</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">etime</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">married</span> <span class="op">+</span> <span class="va">bc_pills</span> <span class="op">+</span></span>
<span>                            <span class="co"># strata(site) + </span></span>
<span>                            <span class="va">bmi</span> <span class="op">+</span> <span class="fu">strata</span><span class="op">(</span><span class="va">ethnic</span><span class="op">)</span> <span class="op">+</span> <span class="fu">strata</span><span class="op">(</span><span class="va">smoke</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">swan_amh1</span>,</span>
<span>                   x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here is the predictive results of joint model from <code>JMbayes2</code> package. We only remove the site from the survival model.</p>
<div class="cell" data-hash="05_jmbayes2_cache/html/jmbayes2.fit11/31.nosite_cf917a5ef6a8e5ee1ecf9bb0a4375919">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">jmcontrol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n_iter <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                  n_burnin <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                  n_chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  seed <span class="op">=</span> <span class="fl">55555</span>,</span>
<span>                  cores <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">jmbayes2.fit11</span> <span class="op">&lt;-</span> <span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/jm.html">jm</a></span><span class="op">(</span>Surv_object <span class="op">=</span> <span class="va">surv.fit1</span>,</span>
<span>                               Mixed_objects <span class="op">=</span> <span class="va">lme.fit1</span>, </span>
<span>                               time_var <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>                               control <span class="op">=</span> <span class="va">jmcontrol</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">jmbayes2.fit11.nosite</span> <span class="op">&lt;-</span> <span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/jm.html">jm</a></span><span class="op">(</span>Surv_object <span class="op">=</span> <span class="va">surv.fit1.nosite</span>,</span>
<span>                                      Mixed_objects <span class="op">=</span> <span class="va">lme.fit1</span>, </span>
<span>                                      time_var <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>                                      control <span class="op">=</span> <span class="va">jmcontrol</span><span class="op">)</span> </span>
<span><span class="co"># functional_forms = NULL,</span></span>
<span></span>
<span></span>
<span><span class="va">jmbayes2.fit31.nosite</span> <span class="op">&lt;-</span> <span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/jm.html">jm</a></span><span class="op">(</span>Surv_object <span class="op">=</span> <span class="va">surv.fit1.nosite</span>,</span>
<span>                                      Mixed_objects <span class="op">=</span> <span class="va">lme.fit3</span>, </span>
<span>                                      time_var <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>                                      control <span class="op">=</span> <span class="va">jmcontrol</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="joint-models-summarization" class="level3" data-number="5.2.2"><h3 data-number="5.2.2" class="anchored" data-anchor-id="joint-models-summarization">
<span class="header-section-number">5.2.2</span> Joint models summarization</h3>
<p>Here is the summary for the joint models</p>
<p><span class="math inline">\(lme.fit1 \sim (fixed = lamh \sim time, \ random = \sim time| id)\)</span></p>
<p><span class="math inline">\(surv.fit1.nosite \sim coxph(Surv(etime, event) \sim married + bc\_pills + bmi + factor(ethnic) + factor(smoke))\)</span></p>
<div class="cell" data-hash="05_jmbayes2_cache/html/unnamed-chunk-4_fc1c1e0d8d3e46bf75b4dadd33d2c01c">
<details><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; JMbayes2::jm(Surv_object = surv.fit1.nosite, Mixed_objects = lme.fit1, 
#&gt;     time_var = "time", control = jmcontrol)
#&gt; 
#&gt; Data Descriptives:
#&gt; Number of Groups: 600        Number of events: 600 (100%)
#&gt; Number of Observations:
#&gt;   lamh: 3326
#&gt; 
#&gt;                  DIC     WAIC      LPML
#&gt; marginal    14864.91 14947.39 -7493.383
#&gt; conditional 15529.92 15309.70 -8097.687
#&gt; 
#&gt; Random-effects covariance matrix:
#&gt;                      
#&gt;        StdDev   Corr 
#&gt; (Intr) 1.6695 (Intr) 
#&gt; time   0.0981 -0.2189
#&gt; 
#&gt; Survival Outcome:
#&gt;                                Mean  StDev    2.5%   97.5%      P   Rhat
#&gt; marriedMarried/Partnered     0.1370 0.1487 -0.1499  0.4318 0.3620 1.0082
#&gt; bc_pillsEver use BC pills   -0.0123 0.1284 -0.2609  0.2445 0.9371 1.0062
#&gt; bmi                         -0.0470 0.0088 -0.0642 -0.0294 0.0000 1.0443
#&gt; factor(ethnic)BLACK         -0.3768 0.1366 -0.6477 -0.1193 0.0020 1.0082
#&gt; factor(ethnic)CHINE         -0.3621 0.1904 -0.7400  0.0139 0.0613 1.0104
#&gt; factor(ethnic)HISPA         -0.2688 0.3638 -0.9652  0.4357 0.4527 1.0980
#&gt; factor(ethnic)JAPAN          0.0949 0.1592 -0.2151  0.4157 0.5393 1.0473
#&gt; factor(smoke)Past Only      -0.0927 0.1301 -0.3378  0.1780 0.4838 1.0019
#&gt; factor(smoke)Current Smoker  0.2262 0.1772 -0.1205  0.5635 0.2100 1.0034
#&gt; value(lamh)                 -0.9795 0.0839 -1.1938 -0.8381 0.0000 1.9560
#&gt; 
#&gt; Longitudinal Outcome: lamh (family = gaussian, link = identity)
#&gt;                Mean  StDev    2.5%   97.5% P   Rhat
#&gt; (Intercept)  7.8964 0.1069  7.6786  8.1089 0 1.1336
#&gt; time        -0.5932 0.0122 -0.6167 -0.5662 0 1.1840
#&gt; sigma        1.3087 0.0196  1.2711  1.3464 0 1.0983
#&gt; 
#&gt; MCMC summary:
#&gt; chains: 3 
#&gt; iterations per chain: 3500 
#&gt; burn-in per chain: 500 
#&gt; thinning: 1 
#&gt; time: 13 sec</code></pre>
</div>
</div>
<p><span class="math inline">\(lme.fit3 \sim (fixed = lamh \sim time + I(time^2), \ random = \sim time + I(time^2) | id)\)</span></p>
<p><span class="math inline">\(surv.fit1.nosite \sim coxph(Surv(etime, event) \sim married + bc\_pills + bmi + factor(ethnic) + factor(smoke))\)</span></p>
<div class="cell" data-hash="05_jmbayes2_cache/html/unnamed-chunk-5_fdab4e8da3dd5951efcdb09bb6f24796">
<details><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">jmbayes2.fit31.nosite</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; JMbayes2::jm(Surv_object = surv.fit1.nosite, Mixed_objects = lme.fit3, 
#&gt;     time_var = "time", control = jmcontrol)
#&gt; 
#&gt; Data Descriptives:
#&gt; Number of Groups: 600        Number of events: 600 (100%)
#&gt; Number of Observations:
#&gt;   lamh: 3326
#&gt; 
#&gt;                  DIC     WAIC      LPML
#&gt; marginal    14586.06 14791.78 -7404.593
#&gt; conditional 11610.39 11463.52 -6301.342
#&gt; 
#&gt; Random-effects covariance matrix:
#&gt;                              
#&gt;        StdDev   Corr         
#&gt; (Intr) 1.1012 (Intr)  00time 
#&gt; time   0.1835 0.5630         
#&gt; I(t^2) 0.0140 -0.4625 -0.6009
#&gt; 
#&gt; Survival Outcome:
#&gt;                                Mean  StDev    2.5%   97.5%      P   Rhat
#&gt; marriedMarried/Partnered     0.1327 0.1603 -0.1777  0.4485 0.4193 1.0004
#&gt; bc_pillsEver use BC pills    0.0183 0.1352 -0.2344  0.2874 0.8967 1.0027
#&gt; bmi                         -0.0493 0.0096 -0.0685 -0.0305 0.0000 1.0178
#&gt; factor(ethnic)BLACK         -0.3812 0.1496 -0.6774 -0.0909 0.0082 1.0081
#&gt; factor(ethnic)CHINE         -0.3529 0.2088 -0.7704  0.0489 0.0849 1.0285
#&gt; factor(ethnic)HISPA         -0.1895 0.4395 -1.0725  0.6252 0.6971 1.0028
#&gt; factor(ethnic)JAPAN          0.1717 0.1749 -0.1743  0.5089 0.3247 1.0011
#&gt; factor(smoke)Past Only      -0.1407 0.1448 -0.4373  0.1322 0.3280 1.0080
#&gt; factor(smoke)Current Smoker  0.2021 0.1977 -0.1781  0.5721 0.3244 1.0080
#&gt; value(lamh)                 -1.0303 0.0701 -1.1732 -0.9045 0.0000 1.0633
#&gt; 
#&gt; Longitudinal Outcome: lamh (family = gaussian, link = identity)
#&gt;                Mean  StDev    2.5%   97.5%     P   Rhat
#&gt; (Intercept)  6.4251 0.1224  6.1925  6.6934 0e+00 1.3366
#&gt; time        -0.0846 0.0359 -0.1839 -0.0295 7e-04 1.5178
#&gt; I(time^2)   -0.0392 0.0030 -0.0437 -0.0315 0e+00 1.2946
#&gt; sigma        1.2631 0.0182  1.2278  1.2998 0e+00 1.0050
#&gt; 
#&gt; MCMC summary:
#&gt; chains: 3 
#&gt; iterations per chain: 3500 
#&gt; burn-in per chain: 500 
#&gt; thinning: 1 
#&gt; time: 15 sec</code></pre>
</div>
</div>
<p>There is no <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> for JMbayes2 package, However, there is the <code>compare_jm</code> function in the package.</p>
<p><strong><em>need to talk with EJC whether we need to include the slope terms</em></strong></p>
<div class="cell" data-hash="05_jmbayes2_cache/html/comparison_efe609e83982728b41189dac3d3109b7">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## there is no anova function in JMbayes2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, <span class="va">jmbayes2.fit31.nosite</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>#&gt; Error in UseMethod("anova"): no applicable method for 'anova' applied to an object of class "jm"</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">compare_jm</span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>,</span>
<span>           <span class="va">jmbayes2.fit31.nosite</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;                             DIC     WAIC      LPML
#&gt;  jmbayes2.fit31.nosite 14586.06 14791.78 -7404.593
#&gt;  jmbayes2.fit11.nosite 14864.91 14947.39 -7493.383
#&gt; 
#&gt; The criteria are calculated based on the marginal log-likelihood.</code></pre>
</div>
</div>
<p>Traceplots with base R, convergence is not so well.</p>
<div>
<details><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">traceplot</span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-hash="05_jmbayes2_cache/html/traceplot_efb6a7d66e28e05e52fa22f4a7422598">

</div>
</div>
<p>Traceplot for the joint model with ggplot</p>
<div>
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggtraceplot</span><span class="op">(</span><span class="va">jmbayes2.fit31.nosite</span>,</span>
<span>            <span class="co">## "betas", "sigmas", </span></span>
<span>            <span class="co">## "D", "bs_gammas",</span></span>
<span>            <span class="co">## "tau_bs_gammas", "gammas", "alphas"</span></span>
<span>            parm <span class="op">=</span> <span class="st">"betas"</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>            alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>            <span class="co">## c('standard', 'catalog', 'metro',</span></span>
<span>            <span class="co">##   'pastel', 'beach', 'moonlight', </span></span>
<span>            <span class="co">##   'goo', 'sunset', 'custom')</span></span>
<span>            theme <span class="op">=</span> <span class="st">"moonlight"</span>,</span>
<span>            grid <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            gridcols <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">ggtraceplot</span><span class="op">(</span><span class="va">jmbayes2.fit31.nosite</span>,</span>
<span>            <span class="co">## "betas", "sigmas", </span></span>
<span>            <span class="co">## "D", "bs_gammas",</span></span>
<span>            <span class="co">## "tau_bs_gammas", "gammas", "alphas"</span></span>
<span>            parm <span class="op">=</span> <span class="st">"gammas"</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>            alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>            <span class="co">## c('standard', 'catalog', 'metro',</span></span>
<span>            <span class="co">##   'pastel', 'beach', 'moonlight', </span></span>
<span>            <span class="co">##   'goo', 'sunset', 'custom')</span></span>
<span>            theme <span class="op">=</span> <span class="st">"moonlight"</span>,</span>
<span>            grid <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            gridcols <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-hash="05_jmbayes2_cache/html/ggtraceplot_09f81c750f8e31fac6546f3a5463e2fd">

</div>
</div>
</section></section><section id="nested-linear-mixed-model" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="nested-linear-mixed-model">
<span class="header-section-number">5.3</span> Nested linear mixed model</h2>
<p>The site is not in the longitudinal dataset <code>swan_amh0</code>, but it is in the survival dataset <code>swan_amh1</code>?</p>
<p>There is some problem for the nested linear mixed model:</p>
<p><a href="https://github.com/drizopoulos/JMbayes2/issues/11">“Indeed, nested random-effects structures are not yet supported in JMbayes2.”</a> by Dimitris Rizopoulos.</p>
<p><span class="math inline">\(lme.fit4 \sim lme(lamh \sim time, random = \sim time| site / id)\)</span></p>
<p><span class="math inline">\(surv.fit1 \sim coxph(Surv(etime, event) \sim married + bc_pills + bmi + factor(ethnic) + factor(smoke)\)</span></p>
<div class="cell" data-hash="05_jmbayes2_cache/html/jmbayes2.fit41.nosite_989f88d323dfa74ce747540af23aa365">
<details><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lme.fit4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; Linear mixed-effects model fit by REML
#&gt;   Data: swan_amh0 
#&gt;        AIC      BIC    logLik
#&gt;   12570.79 12625.77 -6276.396
#&gt; 
#&gt; Random effects:
#&gt;  Formula: ~time | site
#&gt;  Structure: General positive-definite, Log-Cholesky parametrization
#&gt;             StdDev    Corr  
#&gt; (Intercept) 0.4503209 (Intr)
#&gt; time        0.0550350 -0.759
#&gt; 
#&gt;  Formula: ~time | id %in% site
#&gt;  Structure: General positive-definite, Log-Cholesky parametrization
#&gt;             StdDev     Corr  
#&gt; (Intercept) 1.61987662 (Intr)
#&gt; time        0.08386827 -0.295
#&gt; Residual    1.30160865       
#&gt; 
#&gt; Fixed effects:  lamh ~ time 
#&gt;                 Value  Std.Error   DF   t-value p-value
#&gt; (Intercept)  7.503743 0.20297720 2725  36.96840       0
#&gt; time        -0.528080 0.02444278 2725 -21.60476       0
#&gt;  Correlation: 
#&gt;      (Intr)
#&gt; time -0.757
#&gt; 
#&gt; Standardized Within-Group Residuals:
#&gt;        Min         Q1        Med         Q3        Max 
#&gt; -5.2245239 -0.4833631  0.1091414  0.6053437  2.9140076 
#&gt; 
#&gt; Number of Observations: 3326
#&gt; Number of Groups: 
#&gt;         site id %in% site 
#&gt;            7          600</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">jmbayes2.fit41.nosite</span> <span class="op">&lt;-</span> <span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/jm.html">jm</a></span><span class="op">(</span>Surv_object <span class="op">=</span> <span class="va">surv.fit1.nosite</span>,</span>
<span>                                      Mixed_objects <span class="op">=</span> <span class="va">lme.fit4</span>, </span>
<span>                                      time_var <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>#&gt; Error in mat[id, ] &lt;- b: number of items to replace is not a multiple of replacement length</code></pre>
</div>
</div>
<p>Also trying different ways of adding nested or crossed random effects. None of these works with the JMbayes2 package. So including the random <code>site:ethnicity</code> effects does not work through the linear mixed models.</p>
<div class="cell" data-hash="05_jmbayes2_cache/html/jmbayes2.fit51.nosite_790098dcdbc89f17a0ad3ca853c2d4ae">
<details><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lme.fit5</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">lamh</span> <span class="op">~</span> <span class="va">time</span>,</span>
<span>                data <span class="op">=</span> <span class="va">swan_amh0</span>,</span>
<span>                control <span class="op">=</span> <span class="va">control</span>,</span>
<span>                <span class="co">## does not work for the jm model</span></span>
<span>                <span class="co"># random = list(site = pdSymm(~ time),</span></span>
<span>                <span class="co">#               id = pdDiag(~ time)),</span></span>
<span>                <span class="co"># random = list(site = ~ time,</span></span>
<span>                <span class="co">#                id = ~ time),</span></span>
<span>                <span class="co"># random = list(~1 | site,</span></span>
<span>                <span class="co">#               ~time | id),</span></span>
<span>                random <span class="op">=</span> <span class="op">~</span> <span class="va">time</span><span class="op">|</span> <span class="va">site</span> <span class="op">/</span> <span class="va">id</span>,</span>
<span>                <span class="co">## does not work for the jm model</span></span>
<span>                <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lme.fit5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; Linear mixed-effects model fit by REML
#&gt;   Data: swan_amh0 
#&gt;        AIC      BIC    logLik
#&gt;   12570.79 12625.77 -6276.396
#&gt; 
#&gt; Random effects:
#&gt;  Formula: ~time | site
#&gt;  Structure: General positive-definite, Log-Cholesky parametrization
#&gt;             StdDev    Corr  
#&gt; (Intercept) 0.4503209 (Intr)
#&gt; time        0.0550350 -0.759
#&gt; 
#&gt;  Formula: ~time | id %in% site
#&gt;  Structure: General positive-definite, Log-Cholesky parametrization
#&gt;             StdDev     Corr  
#&gt; (Intercept) 1.61987662 (Intr)
#&gt; time        0.08386827 -0.295
#&gt; Residual    1.30160865       
#&gt; 
#&gt; Fixed effects:  lamh ~ time 
#&gt;                 Value  Std.Error   DF   t-value p-value
#&gt; (Intercept)  7.503743 0.20297720 2725  36.96840       0
#&gt; time        -0.528080 0.02444278 2725 -21.60476       0
#&gt;  Correlation: 
#&gt;      (Intr)
#&gt; time -0.757
#&gt; 
#&gt; Standardized Within-Group Residuals:
#&gt;        Min         Q1        Med         Q3        Max 
#&gt; -5.2245239 -0.4833631  0.1091414  0.6053437  2.9140076 
#&gt; 
#&gt; Number of Observations: 3326
#&gt; Number of Groups: 
#&gt;         site id %in% site 
#&gt;            7          600</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">jmbayes2.fit51.nosite</span> <span class="op">&lt;-</span> <span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/jm.html">jm</a></span><span class="op">(</span>Surv_object <span class="op">=</span> <span class="va">surv.fit1.nosite</span>,</span>
<span>                                      Mixed_objects <span class="op">=</span> <span class="va">lme.fit5</span>, </span>
<span>                                      time_var <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>#&gt; Error in mat[id, ] &lt;- b: number of items to replace is not a multiple of replacement length</code></pre>
</div>
</div>
</section><section id="prediction-accuracy" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="prediction-accuracy">
<span class="header-section-number">5.4</span> Prediction Accuracy</h2>
<div class="cell" data-hash="05_jmbayes2_cache/html/jmbayes2_prediction_a3eef03512718414b5b47b3c6eb847e8">
<details><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">swan_amh0</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">## length(ids)</span></span>
<span><span class="co">## Prediction for the survival outcomes</span></span>
<span><span class="va">ND1</span> <span class="op">&lt;-</span> <span class="va">swan_amh0</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ids</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">id</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         <span class="va">time</span> <span class="op">&lt;</span> <span class="va">t0</span><span class="op">)</span></span>
<span><span class="co">## 4, 5, 7 (not so good)</span></span>
<span></span>
<span><span class="va">ND1</span><span class="op">$</span><span class="va">event</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ND1</span><span class="op">$</span><span class="va">etime</span> <span class="op">&lt;-</span> <span class="va">t0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="dynamic-prediction" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="dynamic-prediction">
<span class="header-section-number">5.4.1</span> Dynamic prediction</h3>
<p>Notes: we select the subject for whom we want to calculate predictions, we use measurements up to follow-up year 3; we also set that the patients were alive up to this time point.</p>
<div class="cell" data-hash="05_jmbayes2_cache/html/dyn_predict_dc05ae00cad6f3ea49f15ce5f0a30e83">
<details><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">predLong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                    newdata <span class="op">=</span> <span class="va">ND1</span>,</span>
<span>                    times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                    return_newdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>#&gt; Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">predLong_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                        newdata <span class="op">=</span> <span class="va">swan_amh1</span>,</span>
<span>                        return_newdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predSurv_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                        newdata <span class="op">=</span> <span class="va">ND1</span>,</span>
<span>                        times <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>                        process <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>                        return_newdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>#&gt; Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels</code></pre>
</div>
</div>
</section><section id="auc" class="level3" data-number="5.4.2"><h3 data-number="5.4.2" class="anchored" data-anchor-id="auc">
<span class="header-section-number">5.4.2</span> AUC</h3>
<p>It seems like the AUC, ROC, and Brier Score only works for the prediction for the whole dataset, not for the single individual. I do not know why this keep happening.</p>
<div class="cell" data-hash="05_jmbayes2_cache/html/pred_auc_cb03514afafabc6037cd1c4b1ca83367">
<details><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvAUC</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                <span class="va">swan_amh0</span>, </span>
<span>                Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Time-dependent AUC for the Joint Model jmbayes2.fit11.nosite
#&gt; 
#&gt; Estimated AUC: 0.8293
#&gt; At time: 8
#&gt; Using information up to time: 5 (407 subjects still at risk)</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvAUC</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                <span class="va">ND1</span>, </span>
<span>                Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>#&gt; Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels</code></pre>
</div>
</div>
</section><section id="calibration-plot" class="level3" data-number="5.4.3"><h3 data-number="5.4.3" class="anchored" data-anchor-id="calibration-plot">
<span class="header-section-number">5.4.3</span> Calibration Plot</h3>
<div class="cell" data-hash="05_jmbayes2_cache/html/calibration_plot_ca74dfdeb88516b2854e19a8f1903c0e">
<details><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">calibration_plot</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                           newdata <span class="op">=</span> <span class="va">ND1</span>, </span>
<span>                           Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                           Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>#&gt; Error in JMbayes2::calibration_plot(jmbayes2.fit11.nosite, newdata = ND1, : there are no data on subjects who had an observed event time after Tstart and longitudinal measurements before Tstart.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">calibration_plot</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                           <span class="va">swan_amh0</span>, </span>
<span>                           Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                           Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="05_jmbayes2_files/figure-html/calibration_plot-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># View(swan_amh0) the left truncation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="roc" class="level3" data-number="5.4.4"><h3 data-number="5.4.4" class="anchored" data-anchor-id="roc">
<span class="header-section-number">5.4.4</span> ROC</h3>
<div class="cell" data-hash="05_jmbayes2_cache/html/roc_plot_dadbb3774e6714a79620bf9ceb5af19a">
<details><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvROC</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                <span class="va">ND1</span>, </span>
<span>                Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>#&gt; Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">roc.fit11.nosite</span> <span class="op">&lt;-</span> <span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvROC</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                                    <span class="va">swan_amh0</span>, </span>
<span>                                    Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                    Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">roc.fit11.nosite</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="05_jmbayes2_files/figure-html/roc_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="brier-score" class="level3" data-number="5.4.5"><h3 data-number="5.4.5" class="anchored" data-anchor-id="brier-score">
<span class="header-section-number">5.4.5</span> Brier Score</h3>
<p>However there are several functions in both packages interfering with each other, the <code><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">JMbayes2::tvBrier()</a></code>.</p>
<p>Using the available longitudinal information up to a starting time point, these functions compute estimates of the ROC curve and the AUC, the Brier score and expected predictive cross-entropy at a horizon time point based on joint models.</p>
<p>I can calculate the Brier score for a group of people or the whole dataset, but not for single individual.</p>
<div class="cell" data-hash="05_jmbayes2_cache/html/brier_score_abaebcce2b0cf673c5c6b0db260f234b">
<details><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## I cannot predict for single person </span></span>
<span><span class="co">## but I can predict for the whole dataset</span></span>
<span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvBrier</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                  newdata <span class="op">=</span> <span class="va">ND1</span>, </span>
<span>                  Tstart <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                  Dt <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in br(Thoriz): there are fewer than 5 subjects with an event in the interval [5.000001, 13).</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>#&gt; Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvBrier</a></span><span class="op">(</span><span class="va">jmbayes2.fit11</span>, </span>
<span>                  newdata <span class="op">=</span> <span class="va">ND1</span>, </span>
<span>                  Tstart <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                  Dt <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in br(Thoriz): there are fewer than 5 subjects with an event in the interval [5.000001, 13).</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>#&gt; Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvBrier</a></span><span class="op">(</span><span class="va">jmbayes2.fit11</span>, </span>
<span>                  <span class="va">swan_amh0</span>, </span>
<span>                  integrated <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  <span class="co"># integrated logical; </span></span>
<span>                  <span class="co"># if TRUE the integrated Brier score is calculated</span></span>
<span>                  Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                  Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Prediction Error for the Joint Model 'jmbayes2.fit11'
#&gt; 
#&gt; Estimated Integrated Brier score: 0.0359
#&gt; In the time interval: [5, 8)
#&gt; For the 407 subjects at risk at time 5
#&gt; Number of subjects with an event in [5, 8): 63
#&gt; Number of subjects with a censored time in [5, 8): 0
#&gt; Accounting for censoring using model-based weights</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvBrier</a></span><span class="op">(</span><span class="va">jmbayes2.fit11</span>, </span>
<span>                  <span class="va">swan_amh0</span>, </span>
<span>                  integrated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  <span class="co"># integrated logical; </span></span>
<span>                  <span class="co"># if TRUE the integrated Brier score is calculated</span></span>
<span>                  Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                  Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Prediction Error for the Joint Model 'jmbayes2.fit11'
#&gt; 
#&gt; Estimated Brier score: 0.108
#&gt; At time: 8
#&gt; For the 407 subjects at risk at time 5
#&gt; Number of subjects with an event in [5, 8): 63
#&gt; Number of subjects with a censored time in [5, 8): 0
#&gt; Accounting for censoring using model-based weights</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvBrier</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                  <span class="va">swan_amh0</span>, </span>
<span>                  integrated <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                  Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Prediction Error for the Joint Model 'jmbayes2.fit11.nosite'
#&gt; 
#&gt; Estimated Integrated Brier score: 0.0356
#&gt; In the time interval: [5, 8)
#&gt; For the 407 subjects at risk at time 5
#&gt; Number of subjects with an event in [5, 8): 63
#&gt; Number of subjects with a censored time in [5, 8): 0
#&gt; Accounting for censoring using model-based weights</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">JMbayes2</span><span class="fu">::</span><span class="fu"><a href="https://drizopoulos.github.io/JMbayes2/reference/accuracy.html">tvBrier</a></span><span class="op">(</span><span class="va">jmbayes2.fit11.nosite</span>, </span>
<span>                  <span class="va">swan_amh0</span>, </span>
<span>                  integrated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  Tstart <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                  Thoriz <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Prediction Error for the Joint Model 'jmbayes2.fit11.nosite'
#&gt; 
#&gt; Estimated Brier score: 0.106
#&gt; At time: 8
#&gt; For the 407 subjects at risk at time 5
#&gt; Number of subjects with an event in [5, 8): 63
#&gt; Number of subjects with a censored time in [5, 8): 0
#&gt; Accounting for censoring using model-based weights</code></pre>
</div>
</div>
<ul class="task-list">
<li>
<input type="checkbox" disabled="" checked="">
You are geometric!</li>
</ul>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./04_jmbayes.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">JMBayes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_jm_model_selection.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">JM Model Selection</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb52" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "JMbayes2"</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warnings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">comment =</span> <span class="st">"#&gt;"</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#results = "hide",</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">error =</span> <span class="cn">FALSE</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ## clean the R environment</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># graphics.off()</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co"># rm(list = ls())</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co"># freshr::freshr()</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="do">## load packages</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(JMbayes2, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="do">## check the directory for the file</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="co"># here::dr_here()</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">set_here</span>()</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="do">## the figure or results should be saved </span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="co"># paste0("foldername/Sfilename_workingresult_", </span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="co">#      Sys.Date(), ".filetype")</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{css, "css-setup", echo=FALSE}</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">scroll</span><span class="dv">-100</span> <span class="op">{</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  max<span class="op">-</span>height<span class="op">:</span> 300px<span class="op">;</span></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>  max<span class="op">-</span>width<span class="op">:</span> 1000px<span class="op">;</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>  overflow<span class="op">-</span>y<span class="op">:</span> auto<span class="op">;</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  background<span class="op">-</span>color<span class="op">:</span> inherit<span class="op">;</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Goal for this chapter</span></span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="va">[x]</span> Fitting the models with <span class="in">`JMbayes2`</span> package</span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="va">[x]</span> Removing the site from the survival model, might be the issue!!</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="va">[x]</span> Nested linear model with <span class="in">`id`</span> and <span class="in">`site`</span> failed</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="va">[x]</span> Dynamic predictions for the survival outcomes worked</span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="va">[x]</span> <span class="in">`JM`</span>, <span class="in">`JMbayes`</span>, and <span class="in">`JMbayes2`</span> packages does not support factorized covariates</span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="va">[x]</span> <span class="in">`JMbayes2`</span> for AUC, ROC, calibration plots, and the Brier Score</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="va">[x]</span> <span class="in">`r praise::praise()`</span></span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## No sites in the survival model</span></span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>Here we are working with survival model without site. I also include the site into the nested design random effect in the longitudinal model <span class="in">`lme.fit4`</span>.</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "loading data"</span></span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/swan_amh0.rda"</span>)</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/swan_amh1.rda"</span>)</span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>swan_amh0 <span class="ot">&lt;-</span> swan_amh0 <span class="sc">%&gt;%</span> </span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="fu">case_when</span>(site <span class="sc">==</span> <span class="st">"11"</span> <span class="sc">~</span> <span class="st">"M"</span>,</span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>                          site <span class="sc">==</span> <span class="st">"12"</span> <span class="sc">~</span> <span class="st">"B"</span>,</span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a>                          site <span class="sc">==</span> <span class="st">"13"</span> <span class="sc">~</span> <span class="st">"C"</span>,</span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>                          site <span class="sc">==</span> <span class="st">"14"</span> <span class="sc">~</span> <span class="st">"UCD"</span>,</span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>                          site <span class="sc">==</span> <span class="st">"15"</span> <span class="sc">~</span> <span class="st">"UCLA"</span>,</span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>                          site <span class="sc">==</span> <span class="st">"16"</span> <span class="sc">~</span> <span class="st">"NJ"</span>,</span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a>                          site <span class="sc">==</span> <span class="st">"17"</span> <span class="sc">~</span> <span class="st">"P"</span>))</span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a><span class="fu">### lme models and surv models</span></span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-84"><a href="#cb52-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-85"><a href="#cb52-85" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "fitting models"</span></span>
<span id="cb52-86"><a href="#cb52-86" aria-hidden="true" tabindex="-1"></a>control <span class="ot">=</span> <span class="fu">lmeControl</span>(<span class="at">opt =</span> <span class="st">"optim"</span>)</span>
<span id="cb52-87"><a href="#cb52-87" aria-hidden="true" tabindex="-1"></a>lme.fit1 <span class="ot">&lt;-</span> <span class="fu">lme</span>(lamh <span class="sc">~</span> time,</span>
<span id="cb52-88"><a href="#cb52-88" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> swan_amh0,</span>
<span id="cb52-89"><a href="#cb52-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> control,</span>
<span id="cb52-90"><a href="#cb52-90" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="sc">~</span> time<span class="sc">|</span> id)</span>
<span id="cb52-91"><a href="#cb52-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-92"><a href="#cb52-92" aria-hidden="true" tabindex="-1"></a>lme.fit2 <span class="ot">&lt;-</span> <span class="fu">lme</span>(lamh <span class="sc">~</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb52-93"><a href="#cb52-93" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> swan_amh0,</span>
<span id="cb52-94"><a href="#cb52-94" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> control,</span>
<span id="cb52-95"><a href="#cb52-95" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="sc">~</span> time<span class="sc">|</span> id)</span>
<span id="cb52-96"><a href="#cb52-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-97"><a href="#cb52-97" aria-hidden="true" tabindex="-1"></a>lme.fit3 <span class="ot">&lt;-</span> <span class="fu">lme</span>(lamh <span class="sc">~</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb52-98"><a href="#cb52-98" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> swan_amh0,</span>
<span id="cb52-99"><a href="#cb52-99" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> control,</span>
<span id="cb52-100"><a href="#cb52-100" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="sc">~</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|</span> id)</span>
<span id="cb52-101"><a href="#cb52-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-102"><a href="#cb52-102" aria-hidden="true" tabindex="-1"></a>lme.fit4 <span class="ot">&lt;-</span> <span class="fu">lme</span>(lamh <span class="sc">~</span> time,</span>
<span id="cb52-103"><a href="#cb52-103" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> swan_amh0,</span>
<span id="cb52-104"><a href="#cb52-104" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> control,</span>
<span id="cb52-105"><a href="#cb52-105" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="sc">~</span> time<span class="sc">|</span> site <span class="sc">/</span> id)</span>
<span id="cb52-106"><a href="#cb52-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-107"><a href="#cb52-107" aria-hidden="true" tabindex="-1"></a>surv.fit1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(etime, event) <span class="sc">~</span> married <span class="sc">+</span> bc_pills <span class="sc">+</span> </span>
<span id="cb52-108"><a href="#cb52-108" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">factor</span>(site) <span class="sc">+</span> </span>
<span id="cb52-109"><a href="#cb52-109" aria-hidden="true" tabindex="-1"></a>                        bmi <span class="sc">+</span> <span class="fu">factor</span>(ethnic) <span class="sc">+</span> <span class="fu">factor</span>(smoke),</span>
<span id="cb52-110"><a href="#cb52-110" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> swan_amh1,</span>
<span id="cb52-111"><a href="#cb52-111" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-112"><a href="#cb52-112" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-113"><a href="#cb52-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-114"><a href="#cb52-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-115"><a href="#cb52-115" aria-hidden="true" tabindex="-1"></a>surv.fit1.nosite <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(etime, event) <span class="sc">~</span> married <span class="sc">+</span> bc_pills <span class="sc">+</span> </span>
<span id="cb52-116"><a href="#cb52-116" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># factor(site) + </span></span>
<span id="cb52-117"><a href="#cb52-117" aria-hidden="true" tabindex="-1"></a>                        bmi <span class="sc">+</span> <span class="fu">factor</span>(ethnic) <span class="sc">+</span> <span class="fu">factor</span>(smoke),</span>
<span id="cb52-118"><a href="#cb52-118" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> swan_amh1,</span>
<span id="cb52-119"><a href="#cb52-119" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-120"><a href="#cb52-120" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-121"><a href="#cb52-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-122"><a href="#cb52-122" aria-hidden="true" tabindex="-1"></a>surv.fit2.nosite <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(etime, event) <span class="sc">~</span> married <span class="sc">+</span> bc_pills <span class="sc">+</span></span>
<span id="cb52-123"><a href="#cb52-123" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># strata(site) + </span></span>
<span id="cb52-124"><a href="#cb52-124" aria-hidden="true" tabindex="-1"></a>                            bmi <span class="sc">+</span> <span class="fu">strata</span>(ethnic) <span class="sc">+</span> <span class="fu">strata</span>(smoke),</span>
<span id="cb52-125"><a href="#cb52-125" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> swan_amh1,</span>
<span id="cb52-126"><a href="#cb52-126" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-127"><a href="#cb52-127" aria-hidden="true" tabindex="-1"></a>                   <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-128"><a href="#cb52-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-129"><a href="#cb52-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-130"><a href="#cb52-130" aria-hidden="true" tabindex="-1"></a>Here is the predictive results of joint model from <span class="in">`JMbayes2`</span> package. We only remove the site from the survival model.</span>
<span id="cb52-131"><a href="#cb52-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-134"><a href="#cb52-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-135"><a href="#cb52-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "jmbayes2.fit11/31.nosite"</span></span>
<span id="cb52-136"><a href="#cb52-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-137"><a href="#cb52-137" aria-hidden="true" tabindex="-1"></a>jmcontrol <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n_iter =</span> <span class="dv">5000</span>, </span>
<span id="cb52-138"><a href="#cb52-138" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n_burnin =</span> <span class="dv">1000</span>, </span>
<span id="cb52-139"><a href="#cb52-139" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n_chains =</span> <span class="dv">3</span>,</span>
<span id="cb52-140"><a href="#cb52-140" aria-hidden="true" tabindex="-1"></a>                  <span class="at">seed =</span> <span class="dv">55555</span>,</span>
<span id="cb52-141"><a href="#cb52-141" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cores =</span> <span class="dv">3</span>)</span>
<span id="cb52-142"><a href="#cb52-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-143"><a href="#cb52-143" aria-hidden="true" tabindex="-1"></a>jmbayes2.fit11 <span class="ot">&lt;-</span> JMbayes2<span class="sc">::</span><span class="fu">jm</span>(<span class="at">Surv_object =</span> surv.fit1,</span>
<span id="cb52-144"><a href="#cb52-144" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Mixed_objects =</span> lme.fit1, </span>
<span id="cb52-145"><a href="#cb52-145" aria-hidden="true" tabindex="-1"></a>                               <span class="at">time_var =</span> <span class="st">"time"</span>,</span>
<span id="cb52-146"><a href="#cb52-146" aria-hidden="true" tabindex="-1"></a>                               <span class="at">control =</span> jmcontrol) </span>
<span id="cb52-147"><a href="#cb52-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-148"><a href="#cb52-148" aria-hidden="true" tabindex="-1"></a>jmbayes2.fit11.nosite <span class="ot">&lt;-</span> JMbayes2<span class="sc">::</span><span class="fu">jm</span>(<span class="at">Surv_object =</span> surv.fit1.nosite,</span>
<span id="cb52-149"><a href="#cb52-149" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">Mixed_objects =</span> lme.fit1, </span>
<span id="cb52-150"><a href="#cb52-150" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">time_var =</span> <span class="st">"time"</span>,</span>
<span id="cb52-151"><a href="#cb52-151" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">control =</span> jmcontrol) </span>
<span id="cb52-152"><a href="#cb52-152" aria-hidden="true" tabindex="-1"></a><span class="co"># functional_forms = NULL,</span></span>
<span id="cb52-153"><a href="#cb52-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-154"><a href="#cb52-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-155"><a href="#cb52-155" aria-hidden="true" tabindex="-1"></a>jmbayes2.fit31.nosite <span class="ot">&lt;-</span> JMbayes2<span class="sc">::</span><span class="fu">jm</span>(<span class="at">Surv_object =</span> surv.fit1.nosite,</span>
<span id="cb52-156"><a href="#cb52-156" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">Mixed_objects =</span> lme.fit3, </span>
<span id="cb52-157"><a href="#cb52-157" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">time_var =</span> <span class="st">"time"</span>,</span>
<span id="cb52-158"><a href="#cb52-158" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">control =</span> jmcontrol) </span>
<span id="cb52-159"><a href="#cb52-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-160"><a href="#cb52-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-161"><a href="#cb52-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-162"><a href="#cb52-162" aria-hidden="true" tabindex="-1"></a><span class="fu">### Joint models summarization</span></span>
<span id="cb52-163"><a href="#cb52-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-164"><a href="#cb52-164" aria-hidden="true" tabindex="-1"></a>Here is the summary for the joint models</span>
<span id="cb52-165"><a href="#cb52-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-166"><a href="#cb52-166" aria-hidden="true" tabindex="-1"></a>$lme.fit1 \sim (fixed = lamh \sim time, \ random = \sim time| id)$</span>
<span id="cb52-167"><a href="#cb52-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-168"><a href="#cb52-168" aria-hidden="true" tabindex="-1"></a>$surv.fit1.nosite \sim coxph(Surv(etime, event) \sim married + bc<span class="sc">\_</span>pills + bmi + factor(ethnic) + factor(smoke))$</span>
<span id="cb52-169"><a href="#cb52-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-172"><a href="#cb52-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-173"><a href="#cb52-173" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jmbayes2.fit11.nosite)</span>
<span id="cb52-174"><a href="#cb52-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-175"><a href="#cb52-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-176"><a href="#cb52-176" aria-hidden="true" tabindex="-1"></a>$lme.fit3 \sim (fixed = lamh \sim time + I(time^2), \ random = \sim time + I(time^2) | id)$</span>
<span id="cb52-177"><a href="#cb52-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-178"><a href="#cb52-178" aria-hidden="true" tabindex="-1"></a>$surv.fit1.nosite \sim coxph(Surv(etime, event) \sim married + bc<span class="sc">\_</span>pills + bmi + factor(ethnic) + factor(smoke))$</span>
<span id="cb52-179"><a href="#cb52-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-182"><a href="#cb52-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-183"><a href="#cb52-183" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jmbayes2.fit31.nosite)</span>
<span id="cb52-184"><a href="#cb52-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-185"><a href="#cb52-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-186"><a href="#cb52-186" aria-hidden="true" tabindex="-1"></a>There is no <span class="in">`anova()`</span> for JMbayes2 package, However, there is the <span class="in">`compare_jm`</span> function in the package.</span>
<span id="cb52-187"><a href="#cb52-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-188"><a href="#cb52-188" aria-hidden="true" tabindex="-1"></a>***need to talk with EJC whether we need to include the slope terms***</span>
<span id="cb52-189"><a href="#cb52-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-192"><a href="#cb52-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-193"><a href="#cb52-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "comparison"</span></span>
<span id="cb52-194"><a href="#cb52-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-195"><a href="#cb52-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-196"><a href="#cb52-196" aria-hidden="true" tabindex="-1"></a><span class="do">## there is no anova function in JMbayes2</span></span>
<span id="cb52-197"><a href="#cb52-197" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(jmbayes2.fit11.nosite, jmbayes2.fit31.nosite)</span>
<span id="cb52-198"><a href="#cb52-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-199"><a href="#cb52-199" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_jm</span>(jmbayes2.fit11.nosite,</span>
<span id="cb52-200"><a href="#cb52-200" aria-hidden="true" tabindex="-1"></a>           jmbayes2.fit31.nosite)</span>
<span id="cb52-201"><a href="#cb52-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-202"><a href="#cb52-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-203"><a href="#cb52-203" aria-hidden="true" tabindex="-1"></a>Traceplots with base R, convergence is not so well.</span>
<span id="cb52-204"><a href="#cb52-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-207"><a href="#cb52-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-208"><a href="#cb52-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "traceplot"</span></span>
<span id="cb52-209"><a href="#cb52-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb52-210"><a href="#cb52-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb52-211"><a href="#cb52-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-212"><a href="#cb52-212" aria-hidden="true" tabindex="-1"></a><span class="fu">traceplot</span>(jmbayes2.fit11.nosite)</span>
<span id="cb52-213"><a href="#cb52-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-214"><a href="#cb52-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-215"><a href="#cb52-215" aria-hidden="true" tabindex="-1"></a>Traceplot for the joint model with ggplot</span>
<span id="cb52-216"><a href="#cb52-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-219"><a href="#cb52-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-220"><a href="#cb52-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "ggtraceplot"</span></span>
<span id="cb52-221"><a href="#cb52-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb52-222"><a href="#cb52-222" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb52-223"><a href="#cb52-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-224"><a href="#cb52-224" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtraceplot</span>(jmbayes2.fit31.nosite,</span>
<span id="cb52-225"><a href="#cb52-225" aria-hidden="true" tabindex="-1"></a>            <span class="do">## "betas", "sigmas", </span></span>
<span id="cb52-226"><a href="#cb52-226" aria-hidden="true" tabindex="-1"></a>            <span class="do">## "D", "bs_gammas",</span></span>
<span id="cb52-227"><a href="#cb52-227" aria-hidden="true" tabindex="-1"></a>            <span class="do">## "tau_bs_gammas", "gammas", "alphas"</span></span>
<span id="cb52-228"><a href="#cb52-228" aria-hidden="true" tabindex="-1"></a>            <span class="at">parm =</span> <span class="st">"betas"</span>,</span>
<span id="cb52-229"><a href="#cb52-229" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.3</span>, </span>
<span id="cb52-230"><a href="#cb52-230" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb52-231"><a href="#cb52-231" aria-hidden="true" tabindex="-1"></a>            <span class="do">## c('standard', 'catalog', 'metro',</span></span>
<span id="cb52-232"><a href="#cb52-232" aria-hidden="true" tabindex="-1"></a>            <span class="do">##   'pastel', 'beach', 'moonlight', </span></span>
<span id="cb52-233"><a href="#cb52-233" aria-hidden="true" tabindex="-1"></a>            <span class="do">##   'goo', 'sunset', 'custom')</span></span>
<span id="cb52-234"><a href="#cb52-234" aria-hidden="true" tabindex="-1"></a>            <span class="at">theme =</span> <span class="st">"moonlight"</span>,</span>
<span id="cb52-235"><a href="#cb52-235" aria-hidden="true" tabindex="-1"></a>            <span class="at">grid =</span> <span class="cn">FALSE</span>, </span>
<span id="cb52-236"><a href="#cb52-236" aria-hidden="true" tabindex="-1"></a>            <span class="at">gridcols =</span> <span class="dv">2</span>)</span>
<span id="cb52-237"><a href="#cb52-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-238"><a href="#cb52-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-239"><a href="#cb52-239" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtraceplot</span>(jmbayes2.fit31.nosite,</span>
<span id="cb52-240"><a href="#cb52-240" aria-hidden="true" tabindex="-1"></a>            <span class="do">## "betas", "sigmas", </span></span>
<span id="cb52-241"><a href="#cb52-241" aria-hidden="true" tabindex="-1"></a>            <span class="do">## "D", "bs_gammas",</span></span>
<span id="cb52-242"><a href="#cb52-242" aria-hidden="true" tabindex="-1"></a>            <span class="do">## "tau_bs_gammas", "gammas", "alphas"</span></span>
<span id="cb52-243"><a href="#cb52-243" aria-hidden="true" tabindex="-1"></a>            <span class="at">parm =</span> <span class="st">"gammas"</span>,</span>
<span id="cb52-244"><a href="#cb52-244" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.3</span>, </span>
<span id="cb52-245"><a href="#cb52-245" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb52-246"><a href="#cb52-246" aria-hidden="true" tabindex="-1"></a>            <span class="do">## c('standard', 'catalog', 'metro',</span></span>
<span id="cb52-247"><a href="#cb52-247" aria-hidden="true" tabindex="-1"></a>            <span class="do">##   'pastel', 'beach', 'moonlight', </span></span>
<span id="cb52-248"><a href="#cb52-248" aria-hidden="true" tabindex="-1"></a>            <span class="do">##   'goo', 'sunset', 'custom')</span></span>
<span id="cb52-249"><a href="#cb52-249" aria-hidden="true" tabindex="-1"></a>            <span class="at">theme =</span> <span class="st">"moonlight"</span>,</span>
<span id="cb52-250"><a href="#cb52-250" aria-hidden="true" tabindex="-1"></a>            <span class="at">grid =</span> <span class="cn">FALSE</span>, </span>
<span id="cb52-251"><a href="#cb52-251" aria-hidden="true" tabindex="-1"></a>            <span class="at">gridcols =</span> <span class="dv">2</span>)</span>
<span id="cb52-252"><a href="#cb52-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-253"><a href="#cb52-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-254"><a href="#cb52-254" aria-hidden="true" tabindex="-1"></a><span class="fu">## Nested linear mixed model</span></span>
<span id="cb52-255"><a href="#cb52-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-256"><a href="#cb52-256" aria-hidden="true" tabindex="-1"></a>The site is not in the longitudinal dataset <span class="in">`swan_amh0`</span>, but it is in the survival dataset <span class="in">`swan_amh1`</span>?</span>
<span id="cb52-257"><a href="#cb52-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-258"><a href="#cb52-258" aria-hidden="true" tabindex="-1"></a>There is some problem for the nested linear mixed model:</span>
<span id="cb52-259"><a href="#cb52-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-260"><a href="#cb52-260" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">"Indeed, nested random-effects structures are not yet supported in JMbayes2."</span><span class="co">](https://github.com/drizopoulos/JMbayes2/issues/11)</span> by Dimitris Rizopoulos.</span>
<span id="cb52-261"><a href="#cb52-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-262"><a href="#cb52-262" aria-hidden="true" tabindex="-1"></a>$lme.fit4 \sim lme(lamh \sim time, random = \sim time| site / id)$</span>
<span id="cb52-263"><a href="#cb52-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-264"><a href="#cb52-264" aria-hidden="true" tabindex="-1"></a>$surv.fit1 \sim coxph(Surv(etime, event) \sim married + bc_pills + bmi + factor(ethnic) + factor(smoke)$</span>
<span id="cb52-265"><a href="#cb52-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-268"><a href="#cb52-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-269"><a href="#cb52-269" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "jmbayes2.fit41.nosite"</span></span>
<span id="cb52-270"><a href="#cb52-270" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-271"><a href="#cb52-271" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-272"><a href="#cb52-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-273"><a href="#cb52-273" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lme.fit4)</span>
<span id="cb52-274"><a href="#cb52-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-275"><a href="#cb52-275" aria-hidden="true" tabindex="-1"></a>jmbayes2.fit41.nosite <span class="ot">&lt;-</span> JMbayes2<span class="sc">::</span><span class="fu">jm</span>(<span class="at">Surv_object =</span> surv.fit1.nosite,</span>
<span id="cb52-276"><a href="#cb52-276" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">Mixed_objects =</span> lme.fit4, </span>
<span id="cb52-277"><a href="#cb52-277" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">time_var =</span> <span class="st">"time"</span>) </span>
<span id="cb52-278"><a href="#cb52-278" aria-hidden="true" tabindex="-1"></a>                                      </span>
<span id="cb52-279"><a href="#cb52-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-280"><a href="#cb52-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-281"><a href="#cb52-281" aria-hidden="true" tabindex="-1"></a>Also trying different ways of adding nested or crossed random effects. None of these works with the JMbayes2 package. So including the random <span class="in">`site:ethnicity`</span> effects does not work through the linear mixed models.</span>
<span id="cb52-282"><a href="#cb52-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-285"><a href="#cb52-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-286"><a href="#cb52-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "jmbayes2.fit51.nosite"</span></span>
<span id="cb52-287"><a href="#cb52-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-288"><a href="#cb52-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-289"><a href="#cb52-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-290"><a href="#cb52-290" aria-hidden="true" tabindex="-1"></a>lme.fit5 <span class="ot">&lt;-</span> <span class="fu">lme</span>(lamh <span class="sc">~</span> time,</span>
<span id="cb52-291"><a href="#cb52-291" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> swan_amh0,</span>
<span id="cb52-292"><a href="#cb52-292" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> control,</span>
<span id="cb52-293"><a href="#cb52-293" aria-hidden="true" tabindex="-1"></a>                <span class="do">## does not work for the jm model</span></span>
<span id="cb52-294"><a href="#cb52-294" aria-hidden="true" tabindex="-1"></a>                <span class="co"># random = list(site = pdSymm(~ time),</span></span>
<span id="cb52-295"><a href="#cb52-295" aria-hidden="true" tabindex="-1"></a>                <span class="co">#               id = pdDiag(~ time)),</span></span>
<span id="cb52-296"><a href="#cb52-296" aria-hidden="true" tabindex="-1"></a>                <span class="co"># random = list(site = ~ time,</span></span>
<span id="cb52-297"><a href="#cb52-297" aria-hidden="true" tabindex="-1"></a>                <span class="co">#                id = ~ time),</span></span>
<span id="cb52-298"><a href="#cb52-298" aria-hidden="true" tabindex="-1"></a>                <span class="co"># random = list(~1 | site,</span></span>
<span id="cb52-299"><a href="#cb52-299" aria-hidden="true" tabindex="-1"></a>                <span class="co">#               ~time | id),</span></span>
<span id="cb52-300"><a href="#cb52-300" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="sc">~</span> time<span class="sc">|</span> site <span class="sc">/</span> id,</span>
<span id="cb52-301"><a href="#cb52-301" aria-hidden="true" tabindex="-1"></a>                <span class="do">## does not work for the jm model</span></span>
<span id="cb52-302"><a href="#cb52-302" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb52-303"><a href="#cb52-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-304"><a href="#cb52-304" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lme.fit5)</span>
<span id="cb52-305"><a href="#cb52-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-306"><a href="#cb52-306" aria-hidden="true" tabindex="-1"></a>jmbayes2.fit51.nosite <span class="ot">&lt;-</span> JMbayes2<span class="sc">::</span><span class="fu">jm</span>(<span class="at">Surv_object =</span> surv.fit1.nosite,</span>
<span id="cb52-307"><a href="#cb52-307" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">Mixed_objects =</span> lme.fit5, </span>
<span id="cb52-308"><a href="#cb52-308" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">time_var =</span> <span class="st">"time"</span>) </span>
<span id="cb52-309"><a href="#cb52-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-310"><a href="#cb52-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-311"><a href="#cb52-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction Accuracy</span></span>
<span id="cb52-312"><a href="#cb52-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-315"><a href="#cb52-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-316"><a href="#cb52-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "jmbayes2_prediction"</span></span>
<span id="cb52-317"><a href="#cb52-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-318"><a href="#cb52-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-319"><a href="#cb52-319" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb52-320"><a href="#cb52-320" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(swan_amh0<span class="sc">$</span>id)</span>
<span id="cb52-321"><a href="#cb52-321" aria-hidden="true" tabindex="-1"></a><span class="do">## length(ids)</span></span>
<span id="cb52-322"><a href="#cb52-322" aria-hidden="true" tabindex="-1"></a><span class="do">## Prediction for the survival outcomes</span></span>
<span id="cb52-323"><a href="#cb52-323" aria-hidden="true" tabindex="-1"></a>ND1 <span class="ot">&lt;-</span> swan_amh0 <span class="sc">%&gt;%</span></span>
<span id="cb52-324"><a href="#cb52-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(ids[<span class="dv">5</span>], id[<span class="dv">6</span>]),</span>
<span id="cb52-325"><a href="#cb52-325" aria-hidden="true" tabindex="-1"></a>         time <span class="sc">&lt;</span> t0)</span>
<span id="cb52-326"><a href="#cb52-326" aria-hidden="true" tabindex="-1"></a><span class="do">## 4, 5, 7 (not so good)</span></span>
<span id="cb52-327"><a href="#cb52-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-328"><a href="#cb52-328" aria-hidden="true" tabindex="-1"></a>ND1<span class="sc">$</span>event <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-329"><a href="#cb52-329" aria-hidden="true" tabindex="-1"></a>ND1<span class="sc">$</span>etime <span class="ot">&lt;-</span> t0</span>
<span id="cb52-330"><a href="#cb52-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-331"><a href="#cb52-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-332"><a href="#cb52-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-333"><a href="#cb52-333" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dynamic prediction</span></span>
<span id="cb52-334"><a href="#cb52-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-335"><a href="#cb52-335" aria-hidden="true" tabindex="-1"></a>Notes: we select the subject for whom we want to calculate predictions, we use measurements up to follow-up year 3; we also set that the patients were alive up to this time point.</span>
<span id="cb52-336"><a href="#cb52-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-339"><a href="#cb52-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-340"><a href="#cb52-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "dyn_predict"</span></span>
<span id="cb52-341"><a href="#cb52-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-342"><a href="#cb52-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-343"><a href="#cb52-343" aria-hidden="true" tabindex="-1"></a>predLong <span class="ot">&lt;-</span> <span class="fu">predict</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-344"><a href="#cb52-344" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata =</span> ND1,</span>
<span id="cb52-345"><a href="#cb52-345" aria-hidden="true" tabindex="-1"></a>                    <span class="at">times =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb52-346"><a href="#cb52-346" aria-hidden="true" tabindex="-1"></a>                    <span class="at">return_newdata =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-347"><a href="#cb52-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-348"><a href="#cb52-348" aria-hidden="true" tabindex="-1"></a>predLong_all <span class="ot">&lt;-</span> <span class="fu">predict</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-349"><a href="#cb52-349" aria-hidden="true" tabindex="-1"></a>                        <span class="at">newdata =</span> swan_amh1,</span>
<span id="cb52-350"><a href="#cb52-350" aria-hidden="true" tabindex="-1"></a>                        <span class="at">return_newdata =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-351"><a href="#cb52-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-352"><a href="#cb52-352" aria-hidden="true" tabindex="-1"></a>predSurv_all <span class="ot">&lt;-</span> <span class="fu">predict</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-353"><a href="#cb52-353" aria-hidden="true" tabindex="-1"></a>                        <span class="at">newdata =</span> ND1,</span>
<span id="cb52-354"><a href="#cb52-354" aria-hidden="true" tabindex="-1"></a>                        <span class="at">times =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb52-355"><a href="#cb52-355" aria-hidden="true" tabindex="-1"></a>                        <span class="at">process =</span> <span class="st">"event"</span>,</span>
<span id="cb52-356"><a href="#cb52-356" aria-hidden="true" tabindex="-1"></a>                        <span class="at">return_newdata =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-357"><a href="#cb52-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-358"><a href="#cb52-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-359"><a href="#cb52-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-360"><a href="#cb52-360" aria-hidden="true" tabindex="-1"></a><span class="fu">### AUC</span></span>
<span id="cb52-361"><a href="#cb52-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-362"><a href="#cb52-362" aria-hidden="true" tabindex="-1"></a>It seems like the AUC, ROC, and Brier Score only works for the prediction for the whole dataset, not for the single individual. I do not know why this keep happening.</span>
<span id="cb52-363"><a href="#cb52-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-366"><a href="#cb52-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-367"><a href="#cb52-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "pred_auc"</span></span>
<span id="cb52-368"><a href="#cb52-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-369"><a href="#cb52-369" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvAUC</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-370"><a href="#cb52-370" aria-hidden="true" tabindex="-1"></a>                swan_amh0, </span>
<span id="cb52-371"><a href="#cb52-371" aria-hidden="true" tabindex="-1"></a>                <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-372"><a href="#cb52-372" aria-hidden="true" tabindex="-1"></a>                <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-373"><a href="#cb52-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-374"><a href="#cb52-374" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvAUC</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-375"><a href="#cb52-375" aria-hidden="true" tabindex="-1"></a>                ND1, </span>
<span id="cb52-376"><a href="#cb52-376" aria-hidden="true" tabindex="-1"></a>                <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-377"><a href="#cb52-377" aria-hidden="true" tabindex="-1"></a>                <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-378"><a href="#cb52-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-379"><a href="#cb52-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-380"><a href="#cb52-380" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calibration Plot</span></span>
<span id="cb52-381"><a href="#cb52-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-384"><a href="#cb52-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-385"><a href="#cb52-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "calibration_plot"</span></span>
<span id="cb52-386"><a href="#cb52-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-387"><a href="#cb52-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-388"><a href="#cb52-388" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">calibration_plot</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-389"><a href="#cb52-389" aria-hidden="true" tabindex="-1"></a>                           <span class="at">newdata =</span> ND1, </span>
<span id="cb52-390"><a href="#cb52-390" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-391"><a href="#cb52-391" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-392"><a href="#cb52-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-393"><a href="#cb52-393" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">calibration_plot</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-394"><a href="#cb52-394" aria-hidden="true" tabindex="-1"></a>                           swan_amh0, </span>
<span id="cb52-395"><a href="#cb52-395" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-396"><a href="#cb52-396" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-397"><a href="#cb52-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-398"><a href="#cb52-398" aria-hidden="true" tabindex="-1"></a><span class="co"># View(swan_amh0) the left truncation</span></span>
<span id="cb52-399"><a href="#cb52-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-400"><a href="#cb52-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-401"><a href="#cb52-401" aria-hidden="true" tabindex="-1"></a><span class="fu">### ROC</span></span>
<span id="cb52-402"><a href="#cb52-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-405"><a href="#cb52-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-406"><a href="#cb52-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "roc_plot"</span></span>
<span id="cb52-407"><a href="#cb52-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-408"><a href="#cb52-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-409"><a href="#cb52-409" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvROC</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-410"><a href="#cb52-410" aria-hidden="true" tabindex="-1"></a>                ND1, </span>
<span id="cb52-411"><a href="#cb52-411" aria-hidden="true" tabindex="-1"></a>                <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-412"><a href="#cb52-412" aria-hidden="true" tabindex="-1"></a>                <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-413"><a href="#cb52-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-414"><a href="#cb52-414" aria-hidden="true" tabindex="-1"></a>roc.fit11.nosite <span class="ot">&lt;-</span> JMbayes2<span class="sc">::</span><span class="fu">tvROC</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-415"><a href="#cb52-415" aria-hidden="true" tabindex="-1"></a>                                    swan_amh0, </span>
<span id="cb52-416"><a href="#cb52-416" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-417"><a href="#cb52-417" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-418"><a href="#cb52-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-419"><a href="#cb52-419" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc.fit11.nosite)</span>
<span id="cb52-420"><a href="#cb52-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-421"><a href="#cb52-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-422"><a href="#cb52-422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Brier Score</span></span>
<span id="cb52-423"><a href="#cb52-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-424"><a href="#cb52-424" aria-hidden="true" tabindex="-1"></a>However there are several functions in both packages interfering with each other, the <span class="in">`JMbayes2::tvBrier()`</span>.</span>
<span id="cb52-425"><a href="#cb52-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-426"><a href="#cb52-426" aria-hidden="true" tabindex="-1"></a>Using the available longitudinal information up to a starting time point, these functions compute estimates of the ROC curve and the AUC, the Brier score and expected predictive cross-entropy at a horizon time point based on joint models.</span>
<span id="cb52-427"><a href="#cb52-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-428"><a href="#cb52-428" aria-hidden="true" tabindex="-1"></a>I can calculate the Brier score for a group of people or the whole dataset, but not for single individual.</span>
<span id="cb52-429"><a href="#cb52-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-432"><a href="#cb52-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-433"><a href="#cb52-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "brier_score"</span></span>
<span id="cb52-434"><a href="#cb52-434" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb52-435"><a href="#cb52-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-436"><a href="#cb52-436" aria-hidden="true" tabindex="-1"></a><span class="do">## I cannot predict for single person </span></span>
<span id="cb52-437"><a href="#cb52-437" aria-hidden="true" tabindex="-1"></a><span class="do">## but I can predict for the whole dataset</span></span>
<span id="cb52-438"><a href="#cb52-438" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvBrier</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-439"><a href="#cb52-439" aria-hidden="true" tabindex="-1"></a>                  <span class="at">newdata =</span> ND1, </span>
<span id="cb52-440"><a href="#cb52-440" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Tstart =</span> <span class="dv">5</span>, </span>
<span id="cb52-441"><a href="#cb52-441" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Dt =</span> <span class="dv">8</span>)</span>
<span id="cb52-442"><a href="#cb52-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-443"><a href="#cb52-443" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvBrier</span>(jmbayes2.fit11, </span>
<span id="cb52-444"><a href="#cb52-444" aria-hidden="true" tabindex="-1"></a>                  <span class="at">newdata =</span> ND1, </span>
<span id="cb52-445"><a href="#cb52-445" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Tstart =</span> <span class="dv">5</span>, </span>
<span id="cb52-446"><a href="#cb52-446" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Dt =</span> <span class="dv">8</span>)</span>
<span id="cb52-447"><a href="#cb52-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-448"><a href="#cb52-448" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvBrier</span>(jmbayes2.fit11, </span>
<span id="cb52-449"><a href="#cb52-449" aria-hidden="true" tabindex="-1"></a>                  swan_amh0, </span>
<span id="cb52-450"><a href="#cb52-450" aria-hidden="true" tabindex="-1"></a>                  <span class="at">integrated =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-451"><a href="#cb52-451" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># integrated logical; </span></span>
<span id="cb52-452"><a href="#cb52-452" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># if TRUE the integrated Brier score is calculated</span></span>
<span id="cb52-453"><a href="#cb52-453" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-454"><a href="#cb52-454" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-455"><a href="#cb52-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-456"><a href="#cb52-456" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvBrier</span>(jmbayes2.fit11, </span>
<span id="cb52-457"><a href="#cb52-457" aria-hidden="true" tabindex="-1"></a>                  swan_amh0, </span>
<span id="cb52-458"><a href="#cb52-458" aria-hidden="true" tabindex="-1"></a>                  <span class="at">integrated =</span> <span class="cn">FALSE</span>,</span>
<span id="cb52-459"><a href="#cb52-459" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># integrated logical; </span></span>
<span id="cb52-460"><a href="#cb52-460" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># if TRUE the integrated Brier score is calculated</span></span>
<span id="cb52-461"><a href="#cb52-461" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-462"><a href="#cb52-462" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-463"><a href="#cb52-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-464"><a href="#cb52-464" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvBrier</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-465"><a href="#cb52-465" aria-hidden="true" tabindex="-1"></a>                  swan_amh0, </span>
<span id="cb52-466"><a href="#cb52-466" aria-hidden="true" tabindex="-1"></a>                  <span class="at">integrated =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-467"><a href="#cb52-467" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-468"><a href="#cb52-468" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-469"><a href="#cb52-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-470"><a href="#cb52-470" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">::</span><span class="fu">tvBrier</span>(jmbayes2.fit11.nosite, </span>
<span id="cb52-471"><a href="#cb52-471" aria-hidden="true" tabindex="-1"></a>                  swan_amh0, </span>
<span id="cb52-472"><a href="#cb52-472" aria-hidden="true" tabindex="-1"></a>                  <span class="at">integrated =</span> <span class="cn">FALSE</span>,</span>
<span id="cb52-473"><a href="#cb52-473" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Tstart =</span> <span class="dv">5</span>,</span>
<span id="cb52-474"><a href="#cb52-474" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Thoriz =</span> <span class="dv">8</span>)</span>
<span id="cb52-475"><a href="#cb52-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-476"><a href="#cb52-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-477"><a href="#cb52-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-478"><a href="#cb52-478" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="va">[x]</span> <span class="in">`r praise::praise()`</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>